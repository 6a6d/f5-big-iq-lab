<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Lab 5.3: Deploying AS3 Templates on BIG-IQ</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Lab 5.3: Deploying AS3 Templates on BIG-IQ"/>
  <meta name="product" content="F5 BIG-IQ &amp; Cloud Edition Lab"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2019-07-26 04:33:11"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 BIG-IQ &amp; Cloud Edition Lab" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Lab 5.3: Deploying AS3 Templates on BIG-IQ &#8212; F5 BIG-IQ &amp; Cloud Edition Lab  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 5.4: Delete AS3 Tenant/Applications on BIG-IQ" href="lab4.html" />
    <link rel="prev" title="Lab 5.2: Modify Tenant/Application using AS3" href="lab2.html" />

  
    

  
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 BIG-IQ & Cloud Edition Lab  </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents/Lab:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">Class 1: BIG-IQ Application Management and AS3 (Cloud Edition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">Class 2: BIG-IQ Deployment with auto-scale on AWS, Azure &amp; VMware (Cloud Edition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">Class 3:  BIG-IQ Analytics (Cloud Edition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">Class 4: BIG-IQ Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">Class 5: BIG-IQ Device Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class6/class6.html">Class 6: BIG-IQ ADC Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class7/class7.html">Class 7: BIG-IQ Application Firewall Manager (AFM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class8/class8.html">Class 8: BIG-IQ Application Security Manager (ASM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class9/class9.html">Class 9: BIG-IQ Access Policy Manager (APM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class10/class10.html">Class 10: BIG-IQ DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class11/class11.html">Class 11: BIG-IQ DDoS Monitoring and Dashboard</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 5.3: Deploying AS3 Templates on BIG-IQ</a><ul>
<li><a class="reference internal" href="#task-6-create-custom-http-as3-template-on-big-iq">Task 6 - Create custom HTTP AS3 Template on BIG-IQ</a></li>
<li><a class="reference internal" href="#task-7-admin-set-rbac-for-olivia-on-big-iq">Task 7 - Admin set RBAC for Olivia on BIG-IQ</a></li>
<li><a class="reference internal" href="#task-8-deploy-the-http-application-service-using-a-custom-template">Task 8 - Deploy the HTTP Application Service using a Custom Template</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 BIG-IQ &amp; Cloud Edition Lab</a>
              &gt; <a href="../class1.html">Class 1: BIG-IQ Application Management and AS3 (Cloud Edition)</a>
              &gt; <a href="module5.html">Module 5: BIG-IQ Application Templates &amp; Deployment with AS3 using the API (new 6.1)</a>

          <span class="right">
             <a href="../../_sources/class1/module5/lab3.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-big-iq-lab">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="lab-5-3-deploying-as3-templates-on-big-iq">
<h1>Lab 5.3: Deploying AS3 Templates on BIG-IQ<a class="headerlink" href="#lab-5-3-deploying-as3-templates-on-big-iq" title="Permalink to this headline">¶</a></h1>
<div class="section" id="task-6-create-custom-http-as3-template-on-big-iq">
<h2>Task 6 - Create custom HTTP AS3 Template on BIG-IQ<a class="headerlink" href="#task-6-create-custom-http-as3-template-on-big-iq" title="Permalink to this headline">¶</a></h2>
<p>Administrators will employ the BIG-IQ Service Catalog to construct and manage a set of JSON Schema templates.  Non-administrative users may be selectively allowed to deploy configurations using these templates according to BIG-IQ RBAC policies.  The purpose of the templates is to filter the information being supplied to AS3 in 3 ways:</p>
<ul class="simple">
<li><p>Force the inclusion of specific AS3 class objects</p></li>
<li><p>Restrict specific AS3 properties and/or classes</p></li>
<li><p>Override specific AS3 default property values</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>BIG-IQ 7.0 will bring a User Interface to create and manage the AS3 templates.</p>
</div>
<p>The following examples demonstrate how these goals can be met with JSON Schema.</p>
<ol class="arabic simple">
<li><p>Enforcing Changes to AS3 Classes</p></li>
</ol>
<p>In order to trigger schema enforcement of each class in the template other than Tenant and Application, specify the class name(s) and reference(s) in the Application class additionalProperties, like this:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;allOf&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
         <span class="p p-Indicator">{</span>
             <span class="s">&quot;if&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Service_HTTP&quot;</span><span class="p p-Indicator">}}},</span>
             <span class="s">&quot;then&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;$ref&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;#/definitions/Service_HTTP&quot;</span> <span class="p p-Indicator">}</span>
         <span class="p p-Indicator">},</span>
         <span class="p p-Indicator">{</span>
             <span class="s">&quot;if&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;HTTP_Profile&quot;</span><span class="p p-Indicator">}}},</span>
             <span class="s">&quot;then&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;$ref&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;#/definitions/HTTP_Profile&quot;</span> <span class="p p-Indicator">}</span>
         <span class="p p-Indicator">}</span>
     <span class="p p-Indicator">]</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="2">
<li><p>Overriding an AS3 Default Value</p></li>
</ol>
<p>To override a default, specify the property name, type, and new default like this snippet for the HTTP_Profile class:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;xForwardedFor&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;boolean&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;default&quot;</span><span class="p p-Indicator">:</span> <span class="nv">true</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="3">
<li><p>Setting a Static Value</p></li>
</ol>
<p>To force a property to a specific value and accept no other, specify the property name, type, and const.  To add the static value when the user omits the property, specify the default as well, like this snippet added to the Service_HTTP class:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;virtualPort&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;integer&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="nv">8080</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;default&quot;</span><span class="p p-Indicator">:</span> <span class="nv">8080</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="4">
<li><p>Disallowing One or More Properties</p></li>
</ol>
<p>To reject a specific property whenever it appears in a declaration, specify that property within dependencies, like this snippet added to the Service_HTTP class:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;dependencies&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;policyIAM&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span> <span class="p p-Indicator">},</span>
     <span class="s">&quot;policyWAF&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span> <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="5">
<li><p>Disallowing All Properties Except Those Specified</p></li>
</ol>
<p>To act on a handful of properties and reject all others, make sure to include a stub for the “class” property and specify:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="6">
<li><p>Disallowing One or More Classes</p></li>
</ol>
<p>To reject an entire class, specify this not anyOf properties clause within the Application class additionalProperties object:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">:linenos</span><span class="p p-Indicator">:</span>
 <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
         <span class="s">&quot;anyOf&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
             <span class="p p-Indicator">{</span><span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;TCP_Profile&quot;</span><span class="p p-Indicator">}}},</span>
             <span class="p p-Indicator">{</span><span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;TLS_Client&quot;</span><span class="p p-Indicator">}}}</span>
         <span class="p p-Indicator">]</span>
     <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Disallowing All But 1 or 2 Classes</p></li>
</ol>
<p>To allow just 1 or 2 classes, use an if-then construct within additionalProperties:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;if&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
         <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Service_L4&quot;</span><span class="p p-Indicator">}}</span>
     <span class="p p-Indicator">},</span>
     <span class="s">&quot;then&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;$ref&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;#/definitions/Service_L4&quot;</span> <span class="p p-Indicator">},</span>
     <span class="s">&quot;else&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;if&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Pool&quot;</span><span class="p p-Indicator">}}}},</span>
             <span class="s">&quot;then&quot;</span><span class="p p-Indicator">:</span> <span class="nv">false</span>
     <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<hr class="docutils" />
<p>In this task, we will create a template which require a Service_HTTP object, force the service port to 8080, and prevent WAF (ASM) and IAM (APM) configuration.</p>
<ol class="arabic">
<li><p>Using Postman, use the <strong>BIG-IQ Token (david)</strong> collections to authenticate you on the BIG-IQ and save the token.
If your token expires, obtain a new token by resending the <code class="docutils literal notranslate"><span class="pre">BIG-IQ</span> <span class="pre">Token</span> <span class="pre">(david)</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The token timeout is set to 5 min. If you get the 401 authorization error, request a new token.</p>
</div>
</li>
</ol>
<p>2. Copy the below example of an AS3 service template into the Postman <strong>BIG-IQ AS3 Template Creation</strong> call.
It will create a new template in BIG-IQ AS3 Service Catalogue:</p>
<blockquote>
<div><p>POST <a class="reference external" href="https://10.1.1.4/mgmt/cm/global/appsvcs-templates">https://10.1.1.4/mgmt/cm/global/appsvcs-templates</a></p>
</div></blockquote>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Task</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Create</span><span class="nv"> </span><span class="s">custom</span><span class="nv"> </span><span class="s">HTTP</span><span class="nv"> </span><span class="s">AS3</span><span class="nv"> </span><span class="s">Template</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">BIG-IQ&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;HTTPcustomTemplateTask6&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;schemaOverlay&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
         <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;object&quot;</span><span class="p p-Indicator">,</span>
         <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                 <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span><span class="p p-Indicator">,</span>
                 <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Application&quot;</span>
             <span class="p p-Indicator">},</span>
             <span class="s">&quot;schemaOverlay&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{},</span>
             <span class="s">&quot;label&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{},</span>
             <span class="s">&quot;remark&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{},</span>
             <span class="s">&quot;template&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{},</span>
             <span class="s">&quot;enable&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{},</span>
             <span class="s">&quot;constants&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span>
         <span class="p p-Indicator">},</span>
         <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;allOf&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                 <span class="p p-Indicator">{</span>
                     <span class="s">&quot;if&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                             <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                                 <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Service_HTTP&quot;</span>
                             <span class="p p-Indicator">}</span>
                         <span class="p p-Indicator">}</span>
                     <span class="p p-Indicator">},</span>
                     <span class="s">&quot;then&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;$ref&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;#/definitions/Service_HTTP&quot;</span>
                     <span class="p p-Indicator">}</span>
                 <span class="p p-Indicator">}</span>
             <span class="p p-Indicator">],</span>
             <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                 <span class="s">&quot;anyOf&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                     <span class="p p-Indicator">{</span>
                         <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                             <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                                 <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;IAM_Policy&quot;</span>
                             <span class="p p-Indicator">}</span>
                         <span class="p p-Indicator">}</span>
                     <span class="p p-Indicator">},</span>
                     <span class="p p-Indicator">{</span>
                         <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                             <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                                 <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;WAF_Policy&quot;</span>
                             <span class="p p-Indicator">}</span>
                         <span class="p p-Indicator">}</span>
                     <span class="p p-Indicator">}</span>
                 <span class="p p-Indicator">]</span>
             <span class="p p-Indicator">}</span>
         <span class="p p-Indicator">},</span>
         <span class="s">&quot;required&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
             <span class="s">&quot;class&quot;</span>
         <span class="p p-Indicator">],</span>
         <span class="s">&quot;definitions&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;Service_HTTP&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                 <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;object&quot;</span><span class="p p-Indicator">,</span>
                 <span class="s">&quot;properties&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                     <span class="s">&quot;virtualPort&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;integer&quot;</span><span class="p p-Indicator">,</span>
                         <span class="s">&quot;const&quot;</span><span class="p p-Indicator">:</span> <span class="nv">8080</span><span class="p p-Indicator">,</span>
                         <span class="s">&quot;default&quot;</span><span class="p p-Indicator">:</span> <span class="nv">8080</span>
                     <span class="p p-Indicator">}</span>
                 <span class="p p-Indicator">},</span>
                 <span class="s">&quot;dependencies&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                     <span class="s">&quot;policyIAM&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span>
                     <span class="p p-Indicator">},</span>
                     <span class="s">&quot;policyWAF&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;not&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span>
                     <span class="p p-Indicator">}</span>
                 <span class="p p-Indicator">},</span>
                 <span class="s">&quot;additionalProperties&quot;</span><span class="p p-Indicator">:</span> <span class="nv">true</span>
             <span class="p p-Indicator">}</span>
         <span class="p p-Indicator">}</span>
     <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="3">
<li><p>Logon on BIG-IQ, go to Application tab, then Application Templates. Look at the custom template created previous through the API.</p></li>
</ol>
<p><a class="reference internal" href="../../_images/lab-3-1.png"><img alt="lab-3-1" src="../../_images/lab-3-1.png" style="width: 928.8px; height: 330.0px;" /></a></p>
<p>Note the AS3 Template cannot be created through BIG-IQ UI but only using the API. You can only delete a AS3 templates from the BIG-IQ UI.</p>
<p>You can see the Template in JSON format if you click on it.</p>
<p><a class="reference internal" href="../../_images/lab-3-2.png"><img alt="lab-3-2" src="../../_images/lab-3-2.png" style="width: 946.8px; height: 1077.6px;" /></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For help with JSON Schema, there are lots of resources, but one good place to start is <a class="reference external" href="https://json-schema.org/learn">https://json-schema.org/learn</a>.</p>
</div>
</div>
<div class="section" id="task-7-admin-set-rbac-for-olivia-on-big-iq">
<h2>Task 7 - Admin set RBAC for Olivia on BIG-IQ<a class="headerlink" href="#task-7-admin-set-rbac-for-olivia-on-big-iq" title="Permalink to this headline">¶</a></h2>
<p>Let’s update now Oliva’s service catalog.</p>
<p>Logon on BIG-IQ as <strong>david</strong> go to the System tab, Role Management, Roles, CUSTOM ROLES, Application Roles, select <strong>Application Creator AS3</strong>
and the custom role linked to the custom HTTP template previously created. Remove the <strong>default</strong> template from the allowed list.
Click <strong>Save &amp; Close</strong>.</p>
<p><a class="reference internal" href="../../_images/lab-3-3.png"><img alt="lab-3-3" src="../../_images/lab-3-3.png" style="width: 2304.0px; height: 1127.3999999999999px;" /></a></p>
</div>
<div class="section" id="task-8-deploy-the-http-application-service-using-a-custom-template">
<h2>Task 8 - Deploy the HTTP Application Service using a Custom Template<a class="headerlink" href="#task-8-deploy-the-http-application-service-using-a-custom-template" title="Permalink to this headline">¶</a></h2>
<p>Now, let’s deploy an application as Olivia using the AS3 template previously created in Task 6. Note in the below declaration,
the virtualPort is set to 9090 while in the template, we force the virtualPort to a specific value and accept no other.</p>
<ol class="arabic">
<li><p>Using Postman, use the <strong>BIG-IQ Token (olivia)</strong> collections to authenticate you on the BIG-IQ and save the token.
If your token expires, obtain a new token by resending the <code class="docutils literal notranslate"><span class="pre">BIG-IQ</span> <span class="pre">Token</span> <span class="pre">(olivia)</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The token timeout is set to 5 min. If you get the 401 authorization error, request a new token.</p>
</div>
</li>
<li><p>Copy below example of an AS3 Declaration into the body of the <strong>BIG-IQ AS3 Declaration</strong> collection in order to create the service on the BIG-IP through BIG-IQ:</p></li>
</ol>
<p>POST <a class="reference external" href="https://10.1.1.4/mgmt/shared/appsvcs/declare?async=true">https://10.1.1.4/mgmt/shared/appsvcs/declare?async=true</a></p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p p-Indicator">{</span>
     <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;AS3&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;action&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;deploy&quot;</span><span class="p p-Indicator">,</span>
     <span class="s">&quot;declaration&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
         <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;ADC&quot;</span><span class="p p-Indicator">,</span>
         <span class="s">&quot;schemaVersion&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;3.7.0&quot;</span><span class="p p-Indicator">,</span>
         <span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;isc-lab&quot;</span><span class="p p-Indicator">,</span>
         <span class="s">&quot;label&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Task8&quot;</span><span class="p p-Indicator">,</span>
         <span class="s">&quot;target&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;hostname&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;BOS-vBIGIP01.termmarc.com&quot;</span>
         <span class="p p-Indicator">},</span>
         <span class="s">&quot;Task8&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
             <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Tenant&quot;</span><span class="p p-Indicator">,</span>
             <span class="s">&quot;MyWebApp8http&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                 <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Application&quot;</span><span class="p p-Indicator">,</span>
                 <span class="s">&quot;schemaOverlay&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;HTTPcustomTemplateTask6&quot;</span><span class="p p-Indicator">,</span>
                 <span class="s">&quot;template&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;http&quot;</span><span class="p p-Indicator">,</span>
                 <span class="s">&quot;statsProfile&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                     <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Analytics_Profile&quot;</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;collectClientSideStatistics&quot;</span><span class="p p-Indicator">:</span> <span class="nv">true</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;collectOsAndBrowser&quot;</span><span class="p p-Indicator">:</span> <span class="nv">false</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;collectMethod&quot;</span><span class="p p-Indicator">:</span> <span class="nv">false</span>
                 <span class="p p-Indicator">},</span>
                 <span class="s">&quot;serviceMain&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                     <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Service_HTTP&quot;</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;virtualAddresses&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                         <span class="s">&quot;10.1.10.133&quot;</span>
                     <span class="p p-Indicator">],</span>
<span class="hll">                     <span class="s">&quot;virtualPort&quot;</span><span class="p p-Indicator">:</span> <span class="nv">9090</span><span class="p p-Indicator">,</span>
</span>                     <span class="s">&quot;pool&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;pool_8&quot;</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;profileAnalytics&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                         <span class="s">&quot;use&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;statsProfile&quot;</span>
                     <span class="p p-Indicator">}</span>
                 <span class="p p-Indicator">},</span>
                 <span class="s">&quot;pool_8&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                     <span class="s">&quot;class&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Pool&quot;</span><span class="p p-Indicator">,</span>
                     <span class="s">&quot;monitors&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                         <span class="s">&quot;http&quot;</span>
                     <span class="p p-Indicator">],</span>
                     <span class="s">&quot;members&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                         <span class="p p-Indicator">{</span>
                             <span class="s">&quot;servicePort&quot;</span><span class="p p-Indicator">:</span> <span class="nv">80</span><span class="p p-Indicator">,</span>
                             <span class="s">&quot;serverAddresses&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                                 <span class="s">&quot;10.1.20.132&quot;</span><span class="p p-Indicator">,</span>
                                 <span class="s">&quot;10.1.20.133&quot;</span>
                             <span class="p p-Indicator">],</span>
                             <span class="s">&quot;shareNodes&quot;</span><span class="p p-Indicator">:</span> <span class="nv">true</span>
                         <span class="p p-Indicator">}</span>
                     <span class="p p-Indicator">]</span>
                 <span class="p p-Indicator">}</span>
             <span class="p p-Indicator">}</span>
         <span class="p p-Indicator">}</span>
     <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<p>This will give you an ID which you can query using the <strong>BIG-IQ Check AS3 Deployment Task</strong>.</p>
<ol class="arabic" start="3">
<li><p>Use the <strong>BIG-IQ Check AS3 Deployment Task</strong> Postman calls to ensure that the AS3 deployment is successfull without errors:</p>
<p>GET <a class="reference external" href="https://10.1.1.4/mgmt/shared/appsvcs/task">https://10.1.1.4/mgmt/shared/appsvcs/task</a>/&lt;id&gt;</p>
</li>
<li><p>As expected, note the error message returned due to the static value set in the template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;declaration is invalid according to provided schema overlay: data[&#39;serviceMain&#39;].virtualPort should be equal to constant&quot;</span><span class="p">,</span>
           <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">422</span>
</pre></div>
</div>
</li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">virtualPort</span></code> to <strong>8080</strong> and re-send the declaration.</p></li>
<li><p>Logon on <strong>BOS-vBIGIP01.termmarc.com</strong> and verify the Application is correctly deployed in partition Task8.</p></li>
<li><p>Logon on <strong>BIG-IQ</strong> as Olivia, go to Application tab and check the application is displayed and analytics are showing.</p></li>
</ol>
<p><a class="reference internal" href="../../_images/lab-3-4.png"><img alt="lab-3-4" src="../../_images/lab-3-4.png" style="width: 1566.0px; height: 849.6px;" /></a></p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="lab2.html" title="Lab 5.2: Modify Tenant/Application using AS3" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="lab4.html" title="Lab 5.4: Delete AS3 Tenant/Applications on BIG-IQ" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script src="/assets/js/clouddocs.js"></script>
  <script src="/assets/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>